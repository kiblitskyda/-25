ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(_УчетДолгосрочнойАрендыОбороты.Период, ДЕНЬ) КАК ПериодДень,
	_УчетДолгосрочнойАрендыОбороты.Период КАК Период,
	_УчетДолгосрочнойАрендыОбороты.Регистратор,
	_УчетДолгосрочнойАрендыОбороты.График,
	_УчетДолгосрочнойАрендыОбороты.Договор,
	_УчетДолгосрочнойАрендыОбороты.ОбъектППА,
	_УчетДолгосрочнойАрендыОбороты.ВидДвиженияГрафика,
	_УчетДолгосрочнойАрендыОбороты.Показатель,
	ВЫБОР
		КОГДА _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
				ИЛИ _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.КапитализацияАванса)
			ТОГДА _УчетДолгосрочнойАрендыОбороты.ПериодДисконтирования
		ИНАЧЕ _УчетДолгосрочнойАрендыОбороты.ПериодГрафика
	КОНЕЦ КАК ПериодГрафика,
	ВЫБОР
		КОГДА _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
				ИЛИ _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.КапитализацияАванса)
			ТОГДА _УчетДолгосрочнойАрендыОбороты.ПериодДисконтирования
		ИНАЧЕ "@"
	КОНЕЦ КАК ПериодДисконтирования,
	СУММА(_УчетДолгосрочнойАрендыОбороты.Обязательство) КАК Обязательство,
	СУММА(_УчетДолгосрочнойАрендыОбороты.СтоимостьППА) КАК СтоимостьППА,
	СУММА(_УчетДолгосрочнойАрендыОбороты.НДС) КАК НДС,
	СУММА(_УчетДолгосрочнойАрендыОбороты.АвансОбязательство) КАК АвансОбязательство,
	СУММА(_УчетДолгосрочнойАрендыОбороты.АвансАктив) КАК АвансАктив,
	СУММА(_УчетДолгосрочнойАрендыОбороты.АвансНДС) КАК АвансНДС
ПОМЕСТИТЬ ВТ_Данные
ИЗ
	РегистрСведений._УчетДолгосрочнойАренды КАК _УчетДолгосрочнойАрендыОбороты
ГДЕ
	ВЫБОР
			КОГДА &НачалоПериода <> ДАТАВРЕМЯ(1, 1, 1)
				ТОГДА _УчетДолгосрочнойАрендыОбороты.Период >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ИНАЧЕ ИСТИНА
		КОНЕЦ
	И ВЫБОР
			КОГДА &КонецПериода <> ДАТАВРЕМЯ(1, 1, 1)
				ТОГДА _УчетДолгосрочнойАрендыОбороты.Период <= КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
			ИНАЧЕ ИСТИНА
		КОНЕЦ
	И ВЫБОР
			КОГДА &ГраницаИтогов <> ДАТАВРЕМЯ(1, 1, 1)
				ТОГДА _УчетДолгосрочнойАрендыОбороты.ПериодГрафика <= КОНЕЦПЕРИОДА(&ГраницаИтогов, ДЕНЬ)
			ИНАЧЕ ИСТИНА
		КОНЕЦ
	И 
	(_УчетДолгосрочнойАрендыОбороты.Обязательство = 0
	ИЛИ _УчетДолгосрочнойАрендыОбороты.СтоимостьППА = 0
	ИЛИ _УчетДолгосрочнойАрендыОбороты.НДС = 0
	ИЛИ _УчетДолгосрочнойАрендыОбороты.АвансОбязательство = 0
	ИЛИ _УчетДолгосрочнойАрендыОбороты.АвансАктив = 0
	ИЛИ _УчетДолгосрочнойАрендыОбороты.АвансНДС = 0)

СГРУППИРОВАТЬ ПО
	_УчетДолгосрочнойАрендыОбороты.ОбъектППА,
	_УчетДолгосрочнойАрендыОбороты.Регистратор,
	НАЧАЛОПЕРИОДА(_УчетДолгосрочнойАрендыОбороты.Период, ДЕНЬ),
	_УчетДолгосрочнойАрендыОбороты.Период,
	_УчетДолгосрочнойАрендыОбороты.Показатель,
	ВЫБОР
		КОГДА _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
				ИЛИ _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.КапитализацияАванса)
			ТОГДА _УчетДолгосрочнойАрендыОбороты.ПериодДисконтирования
		ИНАЧЕ _УчетДолгосрочнойАрендыОбороты.ПериодГрафика
	КОНЕЦ,
	_УчетДолгосрочнойАрендыОбороты.Договор,
	_УчетДолгосрочнойАрендыОбороты.ВидДвиженияГрафика,
	_УчетДолгосрочнойАрендыОбороты.График,
	ВЫБОР
		КОГДА _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
				ИЛИ _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ _УчетДолгосрочнойАрендыОбороты.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.КапитализацияАванса)
			ТОГДА _УчетДолгосрочнойАрендыОбороты.ПериодДисконтирования
		ИНАЧЕ "@"
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Данные.ПериодДень,
	ВТ_Данные.Период,
	ВТ_Данные.Регистратор,
	ВТ_Данные.График,
	ВТ_Данные.Договор,
	ВТ_Данные.ОбъектППА,
	ВТ_Данные.ВидДвиженияГрафика,
	ВТ_Данные.Показатель,
	ВТ_Данные.ПериодГрафика,
	КОНЕЦПЕРИОДА(ВТ_Данные.ПериодГрафика, МЕСЯЦ) КАК ПериодГрафикаМесяц,
	ВТ_Данные.ПериодДисконтирования,
	ВТ_Данные.Обязательство,
	ВТ_Данные.СтоимостьППА,
	ВТ_Данные.НДС,
	ВТ_Данные.АвансОбязательство,
	ВТ_Данные.АвансАктив,
	ВТ_Данные.АвансНДС
ИЗ
	ВТ_Данные КАК ВТ_Данные
