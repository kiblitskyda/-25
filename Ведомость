ВЫБРАТЬ
	_УчетДолгосрочнойАренды.Период,
	_УчетДолгосрочнойАренды.Регистратор,
	_УчетДолгосрочнойАренды.НомерСтроки,
	_УчетДолгосрочнойАренды.Активность,
	_УчетДолгосрочнойАренды.ИДСтроки,
	_УчетДолгосрочнойАренды.График,
	_УчетДолгосрочнойАренды.Договор,
	_УчетДолгосрочнойАренды.ОбъектППА,
	_УчетДолгосрочнойАренды.ВидДвиженияГрафика,
	_УчетДолгосрочнойАренды.Показатель,
	_УчетДолгосрочнойАренды.ПериодГрафика,
	_УчетДолгосрочнойАренды.ПериодДисконтирования,
	_УчетДолгосрочнойАренды.ВидОС,
	_УчетДолгосрочнойАренды.Обязательство,
	_УчетДолгосрочнойАренды.СтоимостьППА,
	_УчетДолгосрочнойАренды.НДС,
	_УчетДолгосрочнойАренды.СтавкаНДС,
	_УчетДолгосрочнойАренды.ДатаСобытия
ПОМЕСТИТЬ ВТ_ИсходныеДанные
ИЗ
	РегистрСведений._УчетДолгосрочнойАренды КАК _УчетДолгосрочнойАренды
//ГДЕ
//	_УчетДолгосрочнойАренды.Период <= КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
	//И _УчетДолгосрочнойАренды.Договор = &Договор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	0 КАК Порядок,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
			ТОГДА ИсходныеДанные.ПериодДисконтирования
		ИНАЧЕ ИсходныеДанные.ПериодГрафика
	КОНЕЦ КАК Период,
	ИсходныеДанные.Договор,
	ИсходныеДанные.ОбъектППА,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
			ТОГДА ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК СтоимостьППАНаНачало,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АмортизацияППА)
				И ИсходныеДанные.ПериодГрафика < НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК АмортизацияНакопленнаяНаНачало,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ПроцентыОстатокНаНачало,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ОбязательствоДисконтированноеНаНачало,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство - ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК ОбязательствоПолноеНаНачало,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК НДСНаНачало
ПОМЕСТИТЬ ВТ_НаНачало
ИЗ
	ВТ_ИсходныеДанные КАК ИсходныеДанные
ГДЕ
	ИсходныеДанные.Период < НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	0 КАК Порядок,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
			ТОГДА ИсходныеДанные.ПериодДисконтирования
		ИНАЧЕ ИсходныеДанные.ПериодГрафика
	КОНЕЦ КАК Период,
	ИсходныеДанные.Договор,
	ИсходныеДанные.ОбъектППА,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
			ТОГДА ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК СтоимостьППАНаКонец,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АмортизацияППА)
				И ИсходныеДанные.ПериодГрафика < КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК АмортизацияНакопленнаяНаКонец,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
			ТОГДА ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ПроцентыОстатокНаКонец,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ОбязательствоДисконтированноеНаКонец,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство - ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК ОбязательствоПолноеНаКонец,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК НДСНаКонец
ПОМЕСТИТЬ ВТ_НаКонец
ИЗ
	ВТ_ИсходныеДанные КАК ИсходныеДанные
ГДЕ
	ИсходныеДанные.Период <= КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	0 КАК Порядок,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
			ТОГДА ИсходныеДанные.ПериодДисконтирования
		ИНАЧЕ ИсходныеДанные.ПериодГрафика
	КОНЕЦ КАК Период,
	ИсходныеДанные.Договор,
	ИсходныеДанные.ОбъектППА,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АмортизацияППА)
			ТОГДА -ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК АмортизацияЗаПериод,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
			ТОГДА ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ПроцентыЗаПериод,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
			ТОГДА -ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК АрендныеПлатежиЗаПериод,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
			ТОГДА -ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК НДСЗаПериод
ПОМЕСТИТЬ ВТ_НачисленияЗаПериод
ИЗ
	ВТ_ИсходныеДанные КАК ИсходныеДанные
ГДЕ
	(ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
			ИЛИ ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АмортизацияППА)
			ИЛИ ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты))
	И ИсходныеДанные.ПериодГрафика МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ) И КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
	И ИсходныеДанные.Период <= КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
	И НЕ(ИсходныеДанные.ВидДвиженияГрафика = ЗНАЧЕНИЕ(Перечисление._ВидыДвиженийГрафиковДолгосрочнойАренды.Выбытие)
				И ИсходныеДанные.ДатаСобытия >= ИсходныеДанные.ПериодГрафика)   

//Итоги сумма(АмортизацияЗаПериод), сумма(ПроцентыЗаПериод), сумма (АрендныеПлатежиЗаПериод) по ОбъектППА				
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	0 КАК Порядок,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
			ТОГДА ИсходныеДанные.ПериодДисконтирования
		ИНАЧЕ ИсходныеДанные.ПериодГрафика
	КОНЕЦ КАК Период,
	ИсходныеДанные.Договор,
	ИсходныеДанные.ОбъектППА,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
			ТОГДА ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК СтоимостьППАИзменение,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АмортизацияППА)
				И ИсходныеДанные.ПериодГрафика <= КОНЕЦПЕРИОДА(ИсходныеДанные.Регистратор.Дата, ДЕНЬ)
			ТОГДА -ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК АмортизацияНакопленнаяИзменение,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ОбщаяПриведеннаяСтоимостьИзменение,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство - ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК ОбязательствоПолноеИзменение,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ПроцентыИзменение,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК НДСИзменение
ПОМЕСТИТЬ ВТ_ИзмененияДоговоровЗаПериод
ИЗ
	ВТ_ИсходныеДанные КАК ИсходныеДанные
ГДЕ
	ИсходныеДанные.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ) И КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
	И (ИсходныеДанные.ВидДвиженияГрафика = ЗНАЧЕНИЕ(Перечисление._ВидыДвиженийГрафиковДолгосрочнойАренды.Начисление)
			ИЛИ ИсходныеДанные.ВидДвиженияГрафика = ЗНАЧЕНИЕ(Перечисление._ВидыДвиженийГрафиковДолгосрочнойАренды.Сторно)
			ИЛИ ИсходныеДанные.ВидДвиженияГрафика = ЗНАЧЕНИЕ(Перечисление._ВидыДвиженийГрафиковДолгосрочнойАренды.Корректировка))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	0 КАК Порядок,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
			ТОГДА ИсходныеДанные.ПериодДисконтирования
		ИНАЧЕ ИсходныеДанные.ПериодГрафика
	КОНЕЦ КАК Период,
	ИсходныеДанные.Договор,
	ИсходныеДанные.ОбъектППА,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
			ТОГДА ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК СтоимостьППАПоступление,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АмортизацияППА)
				И ИсходныеДанные.ПериодГрафика <= КОНЕЦПЕРИОДА(ИсходныеДанные.Регистратор.Дата, ДЕНЬ)
			ТОГДА -ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК АмортизацияНакопленнаяПоступление,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ОбщаяПриведеннаяСтоимостьПоступление,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.Обязательство - ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК ОбязательствоПолноеПоступление,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ПроцентыПоступление,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
			ТОГДА -ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК НДСПоступление
ПОМЕСТИТЬ ВТ_ПоступлениеЗаПериод
ИЗ
	ВТ_ИсходныеДанные КАК ИсходныеДанные
ГДЕ
	ИсходныеДанные.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ) И КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
	И ИсходныеДанные.ВидДвиженияГрафика = ЗНАЧЕНИЕ(Перечисление._ВидыДвиженийГрафиковДолгосрочнойАренды.Поступление)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	0 КАК Порядок,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
				ИЛИ ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(Перечисление._ПоказателиГрафиковДолгосрочнойАренды.ПриведеннаяСтоимость)
			ТОГДА ИсходныеДанные.ПериодДисконтирования
		ИНАЧЕ ИсходныеДанные.ПериодГрафика
	КОНЕЦ КАК Период,
	ИсходныеДанные.Договор,
	ИсходныеДанные.ОбъектППА,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.СтоимостьППА)
			ТОГДА ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК СтоимостьППАВыбытие,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АмортизацияППА)
				И ИсходныеДанные.ПериодГрафика <= ИсходныеДанные.ДатаСобытия
			ТОГДА -ИсходныеДанные.СтоимостьППА
		ИНАЧЕ 0
	КОНЕЦ КАК АмортизацияНакопленнаяВыбытие,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= ИсходныеДанные.ДатаСобытия
			ТОГДА -ИсходныеДанные.Обязательство
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= ИсходныеДанные.ДатаСобытия
			ТОГДА -ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ОбщаяПриведеннаяСтоимостьВыбытие,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= ИсходныеДанные.ДатаСобытия
			ТОГДА -ИсходныеДанные.Обязательство - ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК ОбязательствоПолноеВыбытие,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.Проценты)
				И ИсходныеДанные.ПериодГрафика >= ИсходныеДанные.ДатаСобытия
			ТОГДА ИсходныеДанные.Обязательство
		ИНАЧЕ 0
	КОНЕЦ КАК ПроцентыВыбытие,
	ВЫБОР
		КОГДА ИсходныеДанные.Показатель = ЗНАЧЕНИЕ(перечисление._ПоказателиГрафиковДолгосрочнойАренды.АрендныеПлатежи)
				И ИсходныеДанные.ПериодГрафика >= ИсходныеДанные.ДатаСобытия
			ТОГДА -ИсходныеДанные.НДС
		ИНАЧЕ 0
	КОНЕЦ КАК НДСВыбытие
ПОМЕСТИТЬ ВТ_ВыбытиеЗаПериод
ИЗ
	ВТ_ИсходныеДанные КАК ИсходныеДанные
ГДЕ
	ИсходныеДанные.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ) И КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
	И ИсходныеДанные.ВидДвиженияГрафика = ЗНАЧЕНИЕ(Перечисление._ВидыДвиженийГрафиковДолгосрочнойАренды.Выбытие)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_НаНачало.Порядок,
	ВТ_НаНачало.Период,
	ВТ_НаНачало.Договор,
	ВТ_НаНачало.ОбъектППА,
	ВТ_НаНачало.СтоимостьППАНаНачало,
	ВТ_НаНачало.АмортизацияНакопленнаяНаНачало,
	ВТ_НаНачало.ПроцентыОстатокНаНачало,
	ВТ_НаНачало.ОбязательствоДисконтированноеНаНачало,
	ВТ_НаНачало.ОбязательствоПолноеНаНачало,
	ВТ_НаНачало.НДСНаНачало,
	0 КАК СтоимостьППАНаКонец,
	0 КАК АмортизацияНакопленнаяНаКонец,
	0 КАК ПроцентыОстатокНаКонец,
	0 КАК ОбязательствоДисконтированноеНаКонец,
	0 КАК ОбязательствоПолноеНаКонец,
	0 КАК НДСНаКонец,
	0 КАК АмортизацияЗаПериод,
	0 КАК ПроцентыЗаПериод,
	0 КАК АрендныеПлатежиЗаПериод,
	0 КАК НДСЗаПериод,
	0 КАК СтоимостьППАИзменение,
	0 КАК АмортизацияНакопленнаяИзменение,
	0 КАК ОбщаяПриведеннаяСтоимостьИзменение,
	0 КАК ОбязательствоПолноеИзменение,
	0 КАК ПроцентыИзменение,
	0 КАК НДСИзменение,
	0 КАК СтоимостьППАПоступление,
	0 КАК АмортизацияНакопленнаяПоступление,
	0 КАК ОбщаяПриведеннаяСтоимостьПоступление,
	0 КАК ОбязательствоПолноеПоступление,
	0 КАК ПроцентыПоступление,
	0 КАК НДСПоступление,
	0 КАК СтоимостьППАВыбытие,
	0 КАК АмортизацияНакопленнаяВыбытие,
	0 КАК ОбщаяПриведеннаяСтоимостьВыбытие,
	0 КАК ОбязательствоПолноеВыбытие,
	0 КАК ПроцентыВыбытие,
	0 КАК НДСВыбытие
ПОМЕСТИТЬ ВТ_Общая
ИЗ
	ВТ_НаНачало КАК ВТ_НаНачало

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_НаКонец.Порядок,
	ВТ_НаКонец.Период,
	ВТ_НаКонец.Договор,
	ВТ_НаКонец.ОбъектППА,
	0,
	0,
	0,
	0,
	0,
	0,
	ВТ_НаКонец.СтоимостьППАНаКонец,
	ВТ_НаКонец.АмортизацияНакопленнаяНаКонец,
	ВТ_НаКонец.ПроцентыОстатокНаКонец,
	ВТ_НаКонец.ОбязательствоДисконтированноеНаКонец,
	ВТ_НаКонец.ОбязательствоПолноеНаКонец,
	ВТ_НаКонец.НДСНаКонец,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0
ИЗ
	ВТ_НаКонец КАК ВТ_НаКонец

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_НачисленияЗаПериод.Порядок,
	ВТ_НачисленияЗаПериод.Период,
	ВТ_НачисленияЗаПериод.Договор,
	ВТ_НачисленияЗаПериод.ОбъектППА,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	ВТ_НачисленияЗаПериод.АмортизацияЗаПериод,
	ВТ_НачисленияЗаПериод.ПроцентыЗаПериод,
	ВТ_НачисленияЗаПериод.АрендныеПлатежиЗаПериод,
	ВТ_НачисленияЗаПериод.НДСЗаПериод,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0
ИЗ
	ВТ_НачисленияЗаПериод КАК ВТ_НачисленияЗаПериод

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ИзмененияДоговоровЗаПериод.Порядок,
	ВТ_ИзмененияДоговоровЗаПериод.Период,
	ВТ_ИзмененияДоговоровЗаПериод.Договор,
	ВТ_ИзмененияДоговоровЗаПериод.ОбъектППА,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	ВТ_ИзмененияДоговоровЗаПериод.СтоимостьППАИзменение,
	ВТ_ИзмененияДоговоровЗаПериод.АмортизацияНакопленнаяИзменение,
	ВТ_ИзмененияДоговоровЗаПериод.ОбщаяПриведеннаяСтоимостьИзменение,
	ВТ_ИзмененияДоговоровЗаПериод.ОбязательствоПолноеИзменение,
	ВТ_ИзмененияДоговоровЗаПериод.ПроцентыИзменение,
	ВТ_ИзмененияДоговоровЗаПериод.НДСИзменение,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0
ИЗ
	ВТ_ИзмененияДоговоровЗаПериод КАК ВТ_ИзмененияДоговоровЗаПериод

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ПоступлениеЗаПериод.Порядок,
	ВТ_ПоступлениеЗаПериод.Период,
	ВТ_ПоступлениеЗаПериод.Договор,
	ВТ_ПоступлениеЗаПериод.ОбъектППА,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	ВТ_ПоступлениеЗаПериод.СтоимостьППАПоступление,
	ВТ_ПоступлениеЗаПериод.АмортизацияНакопленнаяПоступление,
	ВТ_ПоступлениеЗаПериод.ОбщаяПриведеннаяСтоимостьПоступление,
	ВТ_ПоступлениеЗаПериод.ОбязательствоПолноеПоступление,
	ВТ_ПоступлениеЗаПериод.ПроцентыПоступление,
	ВТ_ПоступлениеЗаПериод.НДСПоступление,
	0,
	0,
	0,
	0,
	0,
	0
ИЗ
	ВТ_ПоступлениеЗаПериод КАК ВТ_ПоступлениеЗаПериод

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ВыбытиеЗаПериод.Порядок,
	ВТ_ВыбытиеЗаПериод.Период,
	ВТ_ВыбытиеЗаПериод.Договор,
	ВТ_ВыбытиеЗаПериод.ОбъектППА,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	ВТ_ВыбытиеЗаПериод.СтоимостьППАВыбытие,
	ВТ_ВыбытиеЗаПериод.АмортизацияНакопленнаяВыбытие,
	ВТ_ВыбытиеЗаПериод.ОбщаяПриведеннаяСтоимостьВыбытие,
	ВТ_ВыбытиеЗаПериод.ОбязательствоПолноеВыбытие,
	ВТ_ВыбытиеЗаПериод.ПроцентыВыбытие,
	ВТ_ВыбытиеЗаПериод.НДСВыбытие
ИЗ
	ВТ_ВыбытиеЗаПериод КАК ВТ_ВыбытиеЗаПериод
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Общая.Порядок,
	ВТ_Общая.Период,
	ВТ_Общая.Договор,
	ВТ_Общая.ОбъектППА,
	СУММА(ВТ_Общая.СтоимостьППАНаНачало) КАК СтоимостьППАНаНачало,
	СУММА(ВТ_Общая.АмортизацияНакопленнаяНаНачало) КАК АмортизацияНакопленнаяНаНачало,
	СУММА(ВТ_Общая.ПроцентыОстатокНаНачало) КАК ПроцентыОстатокНаНачало,
	СУММА(ВТ_Общая.ОбязательствоДисконтированноеНаНачало) КАК ОбязательствоДисконтированноеНаНачало,
	СУММА(ВТ_Общая.ОбязательствоПолноеНаНачало) КАК ОбязательствоПолноеНаНачало,
	СУММА(ВТ_Общая.НДСНаНачало) КАК НДСНаНачало,
	СУММА(ВТ_Общая.СтоимостьППАНаКонец) КАК СтоимостьППАНаКонец,
	СУММА(ВТ_Общая.АмортизацияНакопленнаяНаКонец) КАК АмортизацияНакопленнаяНаКонец,
	СУММА(ВТ_Общая.ПроцентыОстатокНаКонец) КАК ПроцентыОстатокНаКонец,
	СУММА(ВТ_Общая.ОбязательствоДисконтированноеНаКонец) КАК ОбязательствоДисконтированноеНаКонец,
	СУММА(ВТ_Общая.ОбязательствоПолноеНаКонец) КАК ОбязательствоПолноеНаКонец,
	СУММА(ВТ_Общая.НДСНаКонец) КАК НДСНаКонец,
	СУММА(ВТ_Общая.АмортизацияЗаПериод) КАК АмортизацияЗаПериод,
	СУММА(ВТ_Общая.ПроцентыЗаПериод) КАК ПроцентыЗаПериод,
	СУММА(ВТ_Общая.АрендныеПлатежиЗаПериод) КАК АрендныеПлатежиЗаПериод,
	СУММА(ВТ_Общая.НДСЗаПериод) КАК НДСЗаПериод,
	СУММА(ВТ_Общая.СтоимостьППАИзменение) КАК СтоимостьППАИзменение,
	СУММА(ВТ_Общая.АмортизацияНакопленнаяИзменение) КАК АмортизацияНакопленнаяИзменение,
	СУММА(ВТ_Общая.ОбщаяПриведеннаяСтоимостьИзменение) КАК ОбщаяПриведеннаяСтоимостьИзменение,
	СУММА(ВТ_Общая.ОбязательствоПолноеИзменение) КАК ОбязательствоПолноеИзменение,
	СУММА(ВТ_Общая.ПроцентыИзменение) КАК ПроцентыИзменение,
	СУММА(ВТ_Общая.НДСИзменение) КАК НДСИзменение,
	СУММА(ВТ_Общая.СтоимостьППАПоступление) КАК СтоимостьППАПоступление,
	СУММА(ВТ_Общая.АмортизацияНакопленнаяПоступление) КАК АмортизацияНакопленнаяПоступление,
	СУММА(ВТ_Общая.ОбщаяПриведеннаяСтоимостьПоступление) КАК ОбщаяПриведеннаяСтоимостьПоступление,
	СУММА(ВТ_Общая.ОбязательствоПолноеПоступление) КАК ОбязательствоПолноеПоступление,
	СУММА(ВТ_Общая.ПроцентыПоступление) КАК ПроцентыПоступление,
	СУММА(ВТ_Общая.НДСПоступление) КАК НДСПоступление,
	СУММА(ВТ_Общая.СтоимостьППАВыбытие) КАК СтоимостьППАВыбытие,
	СУММА(ВТ_Общая.АмортизацияНакопленнаяВыбытие) КАК АмортизацияНакопленнаяВыбытие,
	СУММА(ВТ_Общая.ОбщаяПриведеннаяСтоимостьВыбытие) КАК ОбщаяПриведеннаяСтоимостьВыбытие,
	СУММА(ВТ_Общая.ОбязательствоПолноеВыбытие) КАК ОбязательствоПолноеВыбытие,
	СУММА(ВТ_Общая.ПроцентыВыбытие) КАК ПроцентыВыбытие,
	СУММА(ВТ_Общая.НДСВыбытие) КАК НДСВыбытие
ПОМЕСТИТЬ ВТ_Группировка
ИЗ
	ВТ_Общая КАК ВТ_Общая

СГРУППИРОВАТЬ ПО
	ВТ_Общая.ОбъектППА,
	ВТ_Общая.Период,
	ВТ_Общая.Договор,
	ВТ_Общая.Порядок
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Группировка.Порядок,
	ВТ_Группировка.Период, 
	НачалоПериода(ВТ_Группировка.Период, Месяц) как Месяц, 
	ВТ_Группировка.Договор,
	ВТ_Группировка.ОбъектППА,
	ВТ_Группировка.СтоимостьППАНаНачало,
	ВТ_Группировка.АмортизацияНакопленнаяНаНачало,
	ВТ_Группировка.ПроцентыОстатокНаНачало,
	ВТ_Группировка.ОбязательствоДисконтированноеНаНачало,
	ВТ_Группировка.ОбязательствоПолноеНаНачало,
	ВТ_Группировка.НДСНаНачало,
	ВТ_Группировка.СтоимостьППАНаКонец,
	ВТ_Группировка.АмортизацияНакопленнаяНаКонец,
	ВТ_Группировка.ПроцентыОстатокНаКонец,
	ВТ_Группировка.ОбязательствоДисконтированноеНаКонец,
	ВТ_Группировка.ОбязательствоПолноеНаКонец,
	ВТ_Группировка.НДСНаКонец,
	ВТ_Группировка.АмортизацияЗаПериод,
	ВТ_Группировка.ПроцентыЗаПериод,
	ВТ_Группировка.АрендныеПлатежиЗаПериод,
	ВТ_Группировка.НДСЗаПериод,
	ВТ_Группировка.СтоимостьППАИзменение,
	ВТ_Группировка.АмортизацияНакопленнаяИзменение,
	ВТ_Группировка.ОбщаяПриведеннаяСтоимостьИзменение,
	ВТ_Группировка.ОбязательствоПолноеИзменение,
	ВТ_Группировка.ПроцентыИзменение,
	ВТ_Группировка.НДСИзменение,
	ВТ_Группировка.СтоимостьППАПоступление,
	ВТ_Группировка.АмортизацияНакопленнаяПоступление,
	ВТ_Группировка.ОбщаяПриведеннаяСтоимостьПоступление,
	ВТ_Группировка.ОбязательствоПолноеПоступление,
	ВТ_Группировка.ПроцентыПоступление,
	ВТ_Группировка.НДСПоступление,
	ВТ_Группировка.СтоимостьППАВыбытие,
	ВТ_Группировка.АмортизацияНакопленнаяВыбытие,
	ВТ_Группировка.ОбщаяПриведеннаяСтоимостьВыбытие,
	ВТ_Группировка.ОбязательствоПолноеВыбытие,
	ВТ_Группировка.ПроцентыВыбытие,
	ВТ_Группировка.НДСВыбытие
ИЗ
	ВТ_Группировка КАК ВТ_Группировка
ГДЕ
	(ВТ_Группировка.СтоимостьППАНаНачало <> 0
			ИЛИ ВТ_Группировка.АмортизацияНакопленнаяНаНачало <> 0
			ИЛИ ВТ_Группировка.ПроцентыОстатокНаНачало <> 0
			ИЛИ ВТ_Группировка.ОбязательствоДисконтированноеНаНачало <> 0
			ИЛИ ВТ_Группировка.ОбязательствоПолноеНаНачало <> 0
			ИЛИ ВТ_Группировка.НДСНаНачало <> 0
			ИЛИ ВТ_Группировка.СтоимостьППАНаКонец <> 0
			ИЛИ ВТ_Группировка.АмортизацияНакопленнаяНаКонец <> 0
			ИЛИ ВТ_Группировка.ПроцентыОстатокНаКонец <> 0
			ИЛИ ВТ_Группировка.ОбязательствоДисконтированноеНаКонец <> 0
			ИЛИ ВТ_Группировка.ОбязательствоПолноеНаКонец <> 0
			ИЛИ ВТ_Группировка.НДСНаКонец <> 0
			ИЛИ ВТ_Группировка.АмортизацияЗаПериод <> 0
			ИЛИ ВТ_Группировка.ПроцентыЗаПериод <> 0
			ИЛИ ВТ_Группировка.АрендныеПлатежиЗаПериод <> 0
			ИЛИ ВТ_Группировка.НДСЗаПериод <> 0
			ИЛИ ВТ_Группировка.СтоимостьППАИзменение <> 0
			ИЛИ ВТ_Группировка.АмортизацияНакопленнаяИзменение <> 0
			ИЛИ ВТ_Группировка.ОбщаяПриведеннаяСтоимостьИзменение <> 0
			ИЛИ ВТ_Группировка.ОбязательствоПолноеИзменение <> 0
			ИЛИ ВТ_Группировка.ПроцентыИзменение <> 0
			ИЛИ ВТ_Группировка.НДСИзменение <> 0
			ИЛИ ВТ_Группировка.СтоимостьППАПоступление <> 0
			ИЛИ ВТ_Группировка.АмортизацияНакопленнаяПоступление <> 0
			ИЛИ ВТ_Группировка.ОбщаяПриведеннаяСтоимостьПоступление <> 0
			ИЛИ ВТ_Группировка.ОбязательствоПолноеПоступление <> 0
			ИЛИ ВТ_Группировка.ПроцентыПоступление <> 0
			ИЛИ ВТ_Группировка.НДСПоступление <> 0
			ИЛИ ВТ_Группировка.СтоимостьППАВыбытие <> 0
			ИЛИ ВТ_Группировка.АмортизацияНакопленнаяВыбытие <> 0
			ИЛИ ВТ_Группировка.ОбщаяПриведеннаяСтоимостьВыбытие <> 0
			ИЛИ ВТ_Группировка.ОбязательствоПолноеВыбытие <> 0
			ИЛИ ВТ_Группировка.ПроцентыВыбытие <> 0
			ИЛИ ВТ_Группировка.НДСВыбытие <> 0)
